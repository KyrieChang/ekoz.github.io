<!DOCTYPE HTML>
<html>
<head>
    <title>我们结婚啦～詹钊和王苏玄于公历10月2日举行婚礼，欢迎您的到来！</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <link href="http://ekoz.github.io/wsxdream/imgs/wsxdream_64X64.ico" type="image/x-icon" rel="shortcut icon">
    <meta name="author" content="Eko James" />

    <link rel="stylesheet" type="text/css" href="../Font-Awesome-4.5.0/css/font-awesome.css">

    <style type="text/css">

        html, body {
            position: relative;
            height: 100%;
            text-align: center;
            overflow: hidden;
        }
        body {
            background: #fff;
            font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
            font-size: 12px;
            color:#000;
            margin: 0px;
            padding: 0;
        }
        div {
            margin-left: auto;
            margin-right: auto;
        }
        img{
            border-radius: 300px;
        }
        .welcome-header, .welcome-footer{
            color: #FF8000;
            font-size: 12px;
            font-weight: bolder;
        }
        /*
        .swiper-slide{
            width:100%;
            height:100%;
        }*/
        #btnPlay{
            position: absolute;
            top: 10px;
            right:10px;
        }
    </style>

    <script type="text/javascript" charset="utf-8" src="../javascripts/jquery.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="resource/trianglify.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="resource/snowfall.min.jquery.js"></script>
    <script type="text/javascript" charset="utf-8" src="resource/arctext/js/jquery.arctext.js"></script>

    <script type="text/javascript">
        var userAgent = window.navigator.userAgent.toLowerCase();
        var isWeixin = userAgent.match(/MicroMessenger/i)=='micromessenger';
        if (!window.confirm("建议在wifi环境下访问，土豪请随意，是否继续？")){
            if (isWeixin){
                WeixinJSBridge.call('closeWindow');
            }else{
                window.close();
            }
        }
    </script>

</head>

    <body>
        <div id="weixinImg" style="display:none;">
            <img src="imgs/wsxdream.jpg"/>
        </div>

        <div class="swiper-container">
            <div class="welcome-header">诚挚的邀请你共享这份喜悦，期待您的光临</div>
            <div class="welcome-header">共同为我们的爱情见证祝福</div>

            <div class="swiper-cell">
                <img class="swiper-slide" src="imgs/1.jpg">
                <img class="swiper-slide" src="imgs/2.jpg">
                <img class="swiper-slide" src="imgs/3.jpg">
            </div>

            <div class="welcome-footer">时间：2016年10月2日 11:30</div>
            <div class="welcome-footer">地址：麻城万豪酒店（麻城广场沃尔玛对面）</div>
        </div>


        <i class="fa fa-pause-circle fa-3x" id="btnPlay" _play="on"></i>
        <audio loop>
            <source src="../music/hai_ku_shi_lan.mp3" type="audio/mp3">
        </audio>
        <script type="text/javascript">
            var _cellHeight = 0;
            var scrWidth = document.documentElement.clientWidth;
            var scrHeight = document.documentElement.clientHeight;

            $('.welcome-header').arctext({radius: 300});
            $('.welcome-footer').arctext({radius: 300, dir:-1});

            if (scrWidth<scrHeight){
                //mobile
                $('.swiper-container').find('.swiper-slide').width(scrWidth).hide();
                //如果不延时100毫秒执行，会导致取得的height为0，这是为什么呢？在webstorm 中需要延时执行，用eclipse开发的时候却不需要，怪怪的，肯定我代码哪里有问题。。。
                //找到bug，因为玫瑰雨导致高度存在问题
                window.setTimeout(function(){
                    _cellHeight = $('.swiper-container .swiper-slide').height();
                    var _top = (scrHeight - _cellHeight)/2;
                    $('.swiper-cell').height(_cellHeight);
                    $('.swiper-container').css({'padding-top': _top-30});
                }, 50);
            }else{
                $('.swiper-container').find('.swiper-slide').height(scrHeight).hide();
                $('.swiper-cell').height($('.swiper-container .swiper-slide').height());
            }
            var children = $('.swiper-container').find('.swiper-slide');
//            window.setTimeout(function(){
//                $(children[0]).animate({height: 0, opacity: 'hide'}, 1000, 'linear', function(){
//                    //$(this).show();
//                });
//            }, 320);
            $(children[0]).show();

            var ind = 1;

            if (isWeixin){
                //微信浏览器中自动播放音频需要特殊处理
                document.addEventListener("WeixinJSBridgeReady", function () {
                    $('audio')[0].play();
                }, false);
            }else{
                //其他浏览器播放音频
                window.setTimeout(function(){
                    $('audio')[0].play();
                }, 0.3*1000);
            }
            $('#btnPlay').click(function(){

                var isPlay = $(this).attr('_play');
                if (isPlay=='on'){
                    //on 正在播放
                    $(this).removeClass('fa-pause-circle').addClass('fa-play-circle').attr('_play', 'off');
                    $('audio')[0].pause();
                }else{
                    //off
                    $(this).removeClass('fa-play-circle').addClass('fa-pause-circle').attr('_play', 'on');
                    $('audio')[0].play();
                }
            });


            //背景色切换
            var trianglify = function(){
                var pattern = Trianglify({
                    width: window.innerWidth,
                    height: window.innerHeight
                });
                document.body.style.backgroundImage = 'url(' + pattern.png() + ')';
            }
            trianglify();
            window.setInterval(function(){
                trianglify();
                $('.swiper-container').find('.swiper-slide').hide(1000);
                $(children[ind]).show(1000);
                ind++;
                if (ind>=children.length) ind=0;
            }, 5*1000);


            //玫瑰雨
            window.setTimeout(function(){
                $('body').snowfall({
                    flakeCount: 6,
                    image :'imgs/rose.png',
                    minSize: 10,
                    maxSize: 32
                });
            }, 350);

        </script>
    </body>
</html>